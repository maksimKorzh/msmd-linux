#!/bin/sh

# Suppress kernel messages
dmesg -n 1
clear && cat /etc/logo.txt

# Mount file systems
mount -t devtmpfs none /dev
mount -t proc none /proc
mount -t sysfs none /sys

# Set permissions
chown root:root / /bin/sudo /etc/sudoers
chmod +s /bin/sudo
chown -R msmd:staff /home /tmp
chmod -R a+x /home /tmp

# Setup networking
for NETDEV in /sys/class/net/* ; do
  ip link set ${NETDEV##*/} up
  [ ${NETDEV##*/} != lo ] && udhcpc -b -i ${NETDEV##*/} -s /etc/network.sh
done

# Start buxybox init as PID 1
exec /sbin/init
